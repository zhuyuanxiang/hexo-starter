---
title: PMP-Net++ 通过学习Transformer强化的多步骤点移动路径实现点云补全
excerpt: 点云补全关注不完整三维形状缺失部分的预测。一种常见的策略是根据不完整的输入来生成完整的形状。然而，点云的无序性会降低高质量三维形状的生成，因为在生成过程中，使用提取的潜在编码很难捕获无序点的结构和拓扑细节。因此，我们通过将补全定义为点云的变形过程来解决这个问题。具体来说，我们设计了一个全新的网络（PMP-Net++），以模拟地动的行为，通过移动每个不完整输入的点以获得一个完整的点云，其中点移动路径（Point Moving Path）的总距离满足最短约束。于是，PMP-Net++根据点移动距离的约束，为每个点预测唯一的PMP。该网络在点的级别上学习了严格的和唯一的对应关系，从而提高了预测的完整形状的质量。此外，由于移动点严重依赖于网络学习到的每个点的特征，我们就进一步推导了一个Transformer强化的表示学习网络，这显著地提高了PMP-Net++的补全性能。我们在形状补全方面进行了全面的实验，并且进一步探索了在点云的上采样方面的应用，这证明了PMP-Net++的比最先进的点云补全/上采样方法有了显著的改进。
categories:
  - 点云补全
tags:
  - 点云补全
  - 地动距离
  - 点移动路径
  - PCN
  - Completion3D
  - Transformer
  - 上采样
date: 2023-11-21
updated: 2023-11-18
toc: true
typora-root-url: D:\Projects\Github\zhuyuanxiang\hexo_pages\hexo-starter\source\_posts\
---

# PMP-Net++ 通过学习Transformer强化的多步骤点移动路径实现点云补全

Wen X, Xiang P, Han Z, et al.  PMP-Net++: Point cloud completion by transformer-enhanced multi-step  point moving paths[J]. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2022, 45(1): 852-867.

[PDF 下载链接](https://arxiv.org/pdf/2202.09507)

[原始代码](https://github.com/diviswen/PMP-Net)

# 摘要

点云补全关注不完整三维形状缺失部分的预测。一种常见的策略是根据不完整的输入来生成完整的形状。然而，点云的无序性会降低高质量三维形状的生成，因为在生成过程中，使用提取的潜在编码很难捕获无序点的结构和拓扑细节。因此，我们通过将补全定义为点云的变形过程来解决这个问题。具体来说，我们设计了一个全新的网络（PMP-Net++），以模拟地动的行为，通过移动每个不完整输入的点以获得一个完整的点云，其中点移动路径（Point Moving Path）的总距离满足最短约束。于是，PMP-Net++根据点移动距离的约束，为每个点预测唯一的PMP。该网络在点的级别上学习了严格的和唯一的对应关系，从而提高了预测的完整形状的质量。此外，由于移动点严重依赖于网络学习到的每个点的特征，我们就进一步推导了一个Transformer强化的表示学习网络，这显著地提高了PMP-Net++的补全性能。我们在形状补全方面进行了全面的实验，并且进一步探索了在点云的上采样方面的应用，这证明了PMP-Net++的比最先进的点云补全/上采样方法有了显著的改进。

# Ch01 简介

点云是一种广泛使用的三维形状表示方法，可以很容易地通过深度摄像机或其他3D扫描设备获得。由于三维扫描设备的视角或遮挡的局限性，原始点云通常是稀疏的和不完整的[^1]。因此，对于下游的3D计算机视觉应用，如分类[^2]、[^3]、[^4]、[^5]、[^6]、[^7]、分割[^8]、[^9]等视觉分析[^10]，通常需要一个形状补全/合并过程来生成三维形状中缺失的区域。

在本文中，我们关注由点云表示的三维对象的补全任务，其中缺失部分是由于扫描仪视角的自遮挡造成的。以往的方法大多将点云补全表述为点云生成问题[^1]、[^11]、[^12]、[^13]，其中通常采用编解码器框架从输入的不完全点云中提取隐藏编码，并将提取的隐藏编码解码为完整的点云。得益于基于深度神经网络的点云学习方法，在这条线上的点云补全方法在过去几年获得了巨大的进展[^1][^13]。然而，利用深度神经网络生成点云仍然是一项困难的任务，因为点云的无序性使得生成模型难以捕获离散点之间详细的拓扑或结构[^13]。因此，基于点云补全的生成模型的性能仍然不理想。

为了提高点云补全性能，本文提出了一种新的深度神经网络PMP-Net++，从一个新的角度来阐述点云补全任务。与直接预测三维空间中所有点的坐标的生成模型不同，PMP-Net++学习将点从源三维形状移动到目标三维形状。通过点移动过程，PMP-Net++学习了源点云与目标点云之间的点级别的对应关系，从而捕获了两个点云之间的拓扑细节和结构关系。另一方面，将点从源移动到目标存在许多可能的解，这将使网络难以很好地训练。因此，为了鼓励网络学习一个独特的最优规划的点移动路径，我们从地动距离（Earth Mover's Distance, EMD）中获得灵感，提出了正则化的Transformer强化的点移动路径网络（Point Moving Path Network, PMP-Net++），该网络的约束为所有点的移动距离（Point Moving Distance, PMD），这个约束保证了源点云与目标点云之间路径规划的唯一性。

图1给出了一个详细的说明。以完成短线$AB$到长线$A'B'$的任务为例，基于生成的神经网络旨在预测$A'B'$的坐标，通常是优化通过倒角距离（CD）或地动距离（EMD）。然而，由于点云数据的离散性，目标矩阵可以说明线$A'B'$拥有多重规划，所有这些规划都将满足CD和EMD的最小损失约束。因此，网络存在多个最优目标，不能引导网络学习短线$AB$和长线$A'B'$之间的详细形状对应关系。相比之下，基于形状变形的神经网络可以在路径约束的指导下，在源输入（$AB$）和目标输出（$A'B'$）之间建立一种直接的和逐个点的对应关系，原因见图1(c)。在网络的输入和输出之间路径约束产生效果，它正则化了点的移动路径，并优化了网络，以预测每个点的唯一位移。在这种情况下，网络的输出是位移，它与每个起点和终点都有局部相关。另一方面，基于生成的网络的输出是坐标矩阵表示的线$A'B'$，其唯一的有监督的源是整体形状约束的CD/EMD，它在输出和目标地面真实值之间生效。

此外，为了预测点的移动路径更加准确，我们提出了一种在多尺度搜索半径下连续细化点移动路径的多步骤路径搜索策略。具体来说，如图2所示，路径搜索以从粗到细的方式重复执行多个步骤。每一步都将考虑到前面预测的路径，然后根据前面的路径规划其下一个移动路径。为了记录和聚合点移动路径的历史信息，我们受门控循环单元（GRU）的启发，提出了一种新的循环路径聚合（RPA）模块。它可以记住和聚合每个点的路线序列，并将之前的信息与点的当前位置结合起来，以预测下一步移动的方向和长度。通过逐步减少搜索半径，PMP-Net++可以一致地为每个点细化一个越来越精确的路径，从不完整点云上的原始位置移动到完整点云上的目标位置。

本文提出的PMP-Net++是对我们最新工作PMP-Net [^14]的增强扩展。我们发现，在移动过程中学习到的点特征在预测高质量的完整形状中起着关键作用。而PMP-Net中使用的基于PointNet++ [^15]的骨架不能提供更多的鉴别点特征，因为其基于最大池的特征聚合策略[^4]。因此，受最近Transformer在点云表示学习[^16]中成功应用的启发，我们在PMP-Net++中引入了一种新的基于Transformer的框架，以增强网络学习到的点特征，目标是预测每个点更准确的位移。总之，我们工作的主要贡献可以总结如下。

- 我们提出了一种新的点云补全任务网络，称为PMP-Net++，可以将不完整形状上的每个点移动到完整形状上的对应点的位置，以实现高精度的点云补全。与以往的生成补全方法相比，PMP-Net++能够通过点移动路径来学习和预测点级别的对应关系，学习不完整形状和完整形状之间拓扑细节和结构关系。
- 我们提出在不完整的点云和完整的点云之间，利用地动距离约束来正则化网络，从而学习一个唯一的点移动距离规划。于是，网络不会被移动点的多个解所混淆，并在原始点云和目标点云之间最终预测出一个有意义的点级别的对应关系。
- 我们建议以从粗到细的方式搜索具有多步骤的点移动路径。每个步骤都将使用提出的循环路径聚合（RPA）模块，从而通过由前一步路径和当前位置聚合的信息来决定下一步的规划。
- 与我们最新的PMP-Net相比，我们在PMP-Net++中进一步引入了一个Transformer强化的点云网络，以改进点特征学习。我们在Completion3D[^13]和PCN [^12]数据集上进行了全面的实验，并进一步探索了点云上采样应用，所有这些都证明了PMP-Net++相比最先进的点云补全/上采样方法（包括我们最新的PMP-Net）有了显著的改进。
