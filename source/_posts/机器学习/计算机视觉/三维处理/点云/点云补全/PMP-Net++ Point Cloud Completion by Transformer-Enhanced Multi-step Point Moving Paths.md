---
title: PMP-Net++ 通过学习Transformer强化的多步骤点移动路径实现点云补全
excerpt: 点云补全关注不完整三维形状缺失部分的预测。一种常见的策略是根据不完整的输入来生成完整的形状。然而，点云的无序性会降低高质量三维形状的生成，因为在生成过程中，使用提取的潜在编码很难捕获无序点的结构和拓扑细节。因此，我们通过将补全定义为点云的变形过程来解决这个问题。具体来说，我们设计了一个全新的网络（PMP-Net++），以模拟地动的行为，通过移动每个不完整输入的点以获得一个完整的点云，其中点移动路径（Point Moving Path）的总距离满足最短约束。于是，PMP-Net++根据点移动距离的约束，为每个点预测唯一的PMP。该网络在点的级别上学习了严格的和唯一的对应关系，从而提高了预测的完整形状的质量。此外，由于移动点严重依赖于网络学习到的每个点的特征，我们就进一步推导了一个Transformer强化的表示学习网络，这显著地提高了PMP-Net++的补全性能。我们在形状补全方面进行了全面的实验，并且进一步探索了在点云的上采样方面的应用，这证明了PMP-Net++的比最先进的点云补全/上采样方法有了显著的改进。
categories:
  - 点云补全
tags:
  - 点云补全
  - 地动距离
  - 点移动路径
  - PCN
  - Completion3D
  - Transformer
  - 上采样
date: 2023-11-21
updated: 2023-11-18
toc: true
typora-root-url: D:\Projects\Github\zhuyuanxiang\hexo_pages\hexo-starter\source\_posts\
---

# PMP-Net++ 通过学习Transformer强化的多步骤点移动路径实现点云补全

Wen X, Xiang P, Han Z, et al.  PMP-Net++: Point cloud completion by transformer-enhanced multi-step  point moving paths[J]. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2022, 45(1): 852-867.

[PDF 下载链接](https://arxiv.org/pdf/2202.09507)

[原始代码](https://github.com/diviswen/PMP-Net)

# 摘要

点云补全关注不完整三维形状缺失部分的预测。一种常见的策略是根据不完整的输入来生成完整的形状。然而，点云的无序性会降低高质量三维形状的生成，因为在生成过程中，使用提取的潜在编码很难捕获无序点的结构和拓扑细节。因此，我们通过将补全定义为点云的变形过程来解决这个问题。具体来说，我们设计了一个全新的网络（PMP-Net++），以模拟地动的行为，通过移动每个不完整输入的点以获得一个完整的点云，其中点移动路径（Point Moving Path）的总距离满足最短约束。于是，PMP-Net++根据点移动距离的约束，为每个点预测唯一的PMP。该网络在点的级别上学习了严格的和唯一的对应关系，从而提高了预测的完整形状的质量。此外，由于移动点严重依赖于网络学习到的每个点的特征，我们就进一步推导了一个Transformer强化的表示学习网络，这显著地提高了PMP-Net++的补全性能。我们在形状补全方面进行了全面的实验，并且进一步探索了在点云的上采样方面的应用，这证明了PMP-Net++的比最先进的点云补全/上采样方法有了显著的改进。

# Ch01 简介

点云是一种广泛使用的三维形状表示方法，可以很容易地通过深度摄像机或其他3D扫描设备获得。由于三维扫描设备的视角或遮挡的局限性，原始点云通常是稀疏的和不完整的[^1]。因此，对于下游的3D计算机视觉应用，如分类[^2]、[^3]、[^4]、[^5]、[^6]、[^7]、分割[^8]、[^9]等视觉分析[^10]，通常需要一个形状补全/合并过程来生成三维形状中缺失的区域。

在本文中，我们关注由点云表示的三维对象的补全任务，其中缺失部分是由于扫描仪视角的自遮挡造成的。以往的方法大多将点云补全表述为点云生成问题[^1]、[^11]、[^12]、[^13]，其中通常采用编解码器框架从输入的不完全点云中提取隐式编码，并将提取的隐式编码解码为完整的点云。得益于基于深度神经网络的点云学习方法，在这条线上的点云补全方法在过去几年获得了巨大的进展[^1][^13]。然而，利用深度神经网络生成点云仍然是一项困难的任务，因为点云的无序性使得生成模型难以捕获离散点之间详细的拓扑或结构[^13]。因此，基于点云补全的生成模型的性能仍然不理想。

为了提高点云补全性能，本文提出了一种新的深度神经网络PMP-Net++，从一个新的角度来阐述点云补全任务。与直接预测三维空间中所有点的坐标的生成模型不同，PMP-Net++学习将点从源三维形状移动到目标三维形状。通过点移动过程，PMP-Net++学习了源点云与目标点云之间的点级别的对应关系，从而捕获了两个点云之间的拓扑细节和结构关系。另一方面，将点从源移动到目标存在许多可能的解，这将使网络难以很好地训练。因此，为了鼓励网络学习一个独特的最优规划的点移动路径，我们从地动距离（Earth Mover's Distance, EMD）中获得灵感，提出了正则化的Transformer强化的点移动路径网络（Point Moving Path Network, PMP-Net++），该网络的约束为所有点的移动距离（Point Moving Distance, PMD），这个约束保证了源点云与目标点云之间路径规划的唯一性。

图1给出了一个详细的说明。以完成短线$AB$到长线$A'B'$的任务为例，基于生成的神经网络旨在预测$A'B'$的坐标，通常是优化通过倒角距离（CD）或地动距离（EMD）。然而，由于点云数据的离散性，目标矩阵可以说明线$A'B'$拥有多重规划，所有这些规划都将满足CD和EMD的最小损失约束。因此，网络存在多个最优目标，不能引导网络学习短线$AB$和长线$A'B'$之间的详细形状对应关系。相比之下，基于形状变形的神经网络可以在路径约束的指导下，在源输入（$AB$）和目标输出（$A'B'$）之间建立一种直接的和逐个点的对应关系，原因见图1(c)。在网络的输入和输出之间路径约束产生效果，它正则化了点的移动路径，并优化了网络，以预测每个点的唯一位移。在这种情况下，网络的输出是位移，它与每个起点和终点都有局部相关。另一方面，基于生成的网络的输出是坐标矩阵表示的线$A'B'$，其唯一的有监督的源是整体形状约束的CD/EMD，它在输出和目标地面真实值之间生效。

此外，为了预测点的移动路径更加准确，我们提出了一种在多尺度搜索半径下连续细化点移动路径的多步骤路径搜索策略。具体来说，如图2所示，路径搜索以从粗到细的方式重复执行多个步骤。每一步都将考虑到前面预测的路径，然后根据前面的路径规划其下一个移动路径。为了记录和聚合点移动路径的历史信息，我们受门控循环单元（GRU）的启发，提出了一种新的循环路径聚合（RPA）模块。它可以记住和聚合每个点的路线序列，并将之前的信息与点的当前位置结合起来，以预测下一步移动的方向和长度。通过逐步减少搜索半径，PMP-Net++可以一致地为每个点细化一个越来越精确的路径，从不完整点云上的原始位置移动到完整点云上的目标位置。

本文提出的PMP-Net++是对我们最新工作PMP-Net [^14]的增强扩展。我们发现，在移动过程中学习到的点特征在预测高质量的完整形状中起着关键作用。而PMP-Net中使用的基于PointNet++ [^15]的骨架不能提供更多的鉴别点特征，因为其基于最大池的特征聚合策略[^4]。因此，受最近Transformer在点云表示学习[^16]中成功应用的启发，我们在PMP-Net++中引入了一种新的基于Transformer的框架，以增强网络学习到的点特征，目标是预测每个点更准确的位移。总之，我们工作的主要贡献可以总结如下。

- 我们提出了一种新的点云补全任务网络，称为PMP-Net++，可以将不完整形状上的每个点移动到完整形状上的对应点的位置，以实现高精度的点云补全。与以往的生成补全方法相比，PMP-Net++能够通过点移动路径来学习和预测点级别的对应关系，学习不完整形状和完整形状之间拓扑细节和结构关系。
- 我们提出在不完整的点云和完整的点云之间，利用地动距离约束来正则化网络，从而学习一个唯一的点移动距离规划。于是，网络不会被移动点的多个解所混淆，并在原始点云和目标点云之间最终预测出一个有意义的点级别的对应关系。
- 我们建议以从粗到细的方式搜索具有多步骤的点移动路径。每个步骤都将使用提出的循环路径聚合（RPA）模块，从而通过由前一步路径和当前位置聚合的信息来决定下一步的规划。
- 与我们最新的PMP-Net相比，我们在PMP-Net++中进一步引入了一个Transformer强化的点云网络，以改进点特征学习。我们在Completion3D[^13]和PCN [^12]数据集上进行了全面的实验，并进一步探索了点云上采样应用，所有这些都证明了PMP-Net++相比最先进的点云补全/上采样方法（包括我们最新的PMP-Net）有了显著的改进。

# Ch02 相关工作

在三维重建[^17]、[^18]、[^19]、[^20]和表示学习[^21]、[^22]、[^23]、[^24]中的深度学习技术促进了三维形状补全的研究，补全方法大致可分为两类：(1)传统的三维形状补全方法[^25][^26][^27][^28]通常公式化手搓特征，如：表面平滑性或对称轴来推断缺失的区域，而其他一些方法[^29][^30][^31][^32]则考虑大规模三维形状补全数据集的辅助，通过执行搜索找到类似的补丁来填补不完整的三维形状。(2)另一方面，基于深度学习的方法[^33]、[^34]、[^35]、[^36]利用其强大的表示学习能力，从不完整的输入形状中提取几何特征，并根据所提取的特征直接推断出完整的形状。与传统的补全方法相比，这些可学习的方法不需要预定义的手搓特征，并且可以更好地利用大尺度补全数据集中丰富的形状信息。所提出的PMP-Net++也属于深度学习领域，其中沿此方向的方法可以进一步分类和细化如下。

## 2.1. 体素辅助的形状补全

卷积神经网络（CNN）的表示学习能力已广泛应用于二维计算机视觉研究中，近年来有关二维图像修复的应用研究风起云涌。2D CNN在[^37]、[^38]、[^39]领域的成功可以直接扩展到三维空间，从而将其借鉴为三维形状补全的直观思想。近年来，人们提出了几种基于3D CNN结构的体积辅助形状补全方法。请注意，我们使用术语“体素辅助”来描述这类方法，是因为3D体素通常不是网络的最终输出。相反，预测的体素将被进一步细化，并转换为其他表示形式，如网格[^11]或点云[^40]，以产生更精细的3D形状。因此，体素更像是一个中间辅助工具，以帮助完成网络推断出完整的形状。沿着这个思路出现的值得注意的工作，如3D-EPN [^11]和GRNet [^40]已经提出以粗到细的方式重建完整的3D体素。他们首先在编码器-解码器框架下使用三维CNN预测一个粗糙的完整形状，然后使用从一个补全形状数据集[^11]中选择相似的补丁来细化输出，或根据输出的体素[^40]进一步重建点云的细节。此外，也有一些研究考虑使用纯粹的体素数据来实现形状补全任务。例如，Han等人[^41]提出通过同时推断全局结构和局部几何形状，来预测补全形状的细节，从而直接生成高分辨率的三维体素形状。Stutz等人[^42]提出了一种基于变分自动编码器的方法来在弱监督下补全三维体素。尽管3D CNN在特征学习方面令人动心，但输入体素数据的分辨率的立方计算成本，使得处理细粒度形状[^1]变得困难。

## 2.2. 基于点云的形状补全

近年来，基于点云的形状补全[^1]、[^13]、[^43]、[^44]任务越来越受到关注。由于点云是许多三维扫描设备的直接输出形式，而且点云的存储和处理需要的计算成本比体素数据低得多，因此最近的许多研究考虑对三维点云进行直接补全。从点云表示学习[^15]、[^45]的改进中可以看出，之前的方法，如：TopNet [^13]、PCN [^12]和SA-Net [^1]将解决方案制定为编码器-解码器框架下的生成模型。他们采用PointNet [45]等编码器从不完整点云中提取全局特征，并使用解码器根据提取的特征推断完整点云。与PCN [^12]相比，TopNet [^13]改进了解码器的结构，以便在一个根树架构[^13]中隐式地建模和生成点云。SANet [^1]进一步通过跳跃注意机制将不完整形状的详细几何信息传递为完整形状。其他值得注意的方法，如：RL-GAN-Net[^34]，Render4Completion[^44]和VRCNet [^46]，专注于对抗性学习和变分自动编码器的框架，以提高生成的完整形状的真实性和一致性。近年来，三维形状的逐步细化（如：CRN [^47]，PF-Net [^35]）已成为点云补全研究中的一个流行思想，因为它可以帮助网络生成具有结构细节的三维形状。

综上所述，上述方法大多是点云补全任务的生成式解决方案，不可避免地受点云的无序性影响，使得使用生成式解码器重建结构或者拓扑细节变得困难。因此，为了避免预测无序数据的问题，PMP-Net++使用了一种不同的方法来重建完整的点云，它学习从初始输入中移动所有的点，而不是直接从隐式编码中生成最终的点云。

PMP-Net++的思想也与三维形状变形[^48]的研究有关，它[^48]主要考虑了一步变形。然而，不完整形状和完整形状之间的变形更具挑战性，这需要在没有任何其他先验信息的情况下，推断缺失区域中完全未知的几何形状。相比之下，我们建议采用多步搜索来鼓励PMP-Net++对缺失区域推断出更详细的几何信息，以及通过正则化点移动距离，以保证多步推理的有效性。
