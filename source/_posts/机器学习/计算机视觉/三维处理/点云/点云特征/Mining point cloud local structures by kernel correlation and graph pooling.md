---
title: 通过核相关和图池化来挖掘点云的局部结构
excerpt: 形状补全，是许多视觉和机器人应用的核心问题。目标是从部分观测中估计对象的完整几何形状。在本文中，我们提出了点补全网络（Point Completion Network, PCN），一种新颖的基于学习的形状补全方法。与现有的形状补全方法不同，PCN直接对原始点云进行操作，没有任何关于底层形状的结构假设（如：对称性）或者标注（如：语义类别）。它的特点是一个解码器的设计，能够生成细粒度的补全，同时维护少量的参数。我们的实验表明，PCN在基于不同水平的不完整数据和噪声的输入（包括来自KITTI数据集中使用激光雷达扫描得到的汽车数据）下都在现实结构的缺失区域中补全了稠密的、完整的点云。
categories:
  - 点云特征
tags:
  - 点云特征
  - 折叠网络
  - FoldingNet
  - ShapeNet
  - ModelNet
date: 2023-11-28
updated: 2023-11-28
toc: true
typora-root-url: D:\Projects\Github\zhuyuanxiang\hexo_pages\hexo-starter\source\_posts\
---

# 通过核相关和图池化来挖掘点云的局部结构

Shen Y, Feng C, Yang Y, et al. Mining point cloud local structures by kernel correlation and graph pooling[C]//Proceedings of the IEEE conference on computer vision and pattern recognition. 2018: 4548-4557.

[原始论文](https://openaccess.thecvf.com/content_cvpr_2018/papers/Shen_Mining_Point_Cloud_CVPR_2018_paper.pdf)

[中文翻译]()

[原始代码_PyTorch](https://github.com/ftdlyc/KCNet_Pytorch)

[论文作者实验室主页]([Software & Data Downloads | Mitsubishi Electric Research Laboratories (merl.com)](https://www.merl.com/research/license#KCNet))

# 摘要

与图像不同，使用深度网络的三维点云的语义学习具有挑战性。在现有的工作中，PointNet通过直接的点集学习取得了很好的效果。然而，它并没有充分利用一个点的包含细粒度结构信息的局部邻域，这些领域将有助于更好的语义学习。在这方面，我们提出了两种新的操作来改进PointNet，以更有效地利用局部结构。第一个操作侧重于局部的三维几何结构。与图像的卷积核类似，我们将点集核定义为一组可学习的三维点，这些三维点根据核相关性度量的几何匹配度，共同响应一组相邻的数据点，这个方法采用了点云配准类似的技术。第二个操作利用了在三维位置计算出的最近邻图上通过递归的聚合探索了局部高维特征结构。实验表明，该网络能够在主要数据集上有效地捕获局部信息，并稳健地获得更好的性能。

![image-20231204170154076](/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/%E4%B8%89%E7%BB%B4%E5%A4%84%E7%90%86/%E7%82%B9%E4%BA%91/%E7%82%B9%E4%BA%91%E7%89%B9%E5%BE%81/images/Mining%20point%20cloud%20local%20structures%20by%20kernel%20correlation%20and%20graph%20pooling/image-20231204170154076.png)

图1：可视化学习到的核的相关性。为了表示点p周围的复杂的局部几何结构，我们提出了核相关性来度量两个点集之间的匹配度：p的相邻点和核点。此图显示了核点的位置和宽度作为球体的中心和半径（顶部行），以及在4个对象上的5个核的对应过滤器响应（其他行）。颜色表示每个物体的亲合力（红色：最强，白色：最弱）。注意由不同的内核捕获的各种结构（平面、边、角、凹面和凸面）。

# Ch01 简介

随着各种三维传感器的快速发展，三维数据变得无处不在，由于[3,20,29,32,41]在机器人技术、自动驾驶、逆向工程和民用基础设施监测方面的广泛应用，利用深度网络对这类数据的语义理解和分析正受到人们的关注。特别是，三维点云作为最原始的3D数据格式之一和最常见的原始3D传感器输出，它不能像卷积网络的2D图像那样被深度网络简单地使用。这主要是由于点的不规则组织造成的，这是这种原始数据格式所固有的一个基本挑战：相比行列索引的图像，点云是一组点坐标（可能具有强度和表面法线等属性），在点之间没有明显的顺序，从深度图中计算出来的点云除外。

然而，受图像卷积网络成功的影响，许多工作都集中在3D体素上，即在学习过程之前从点云转换成的规则3D网格。只有这样，三维卷积网络才能学会从体素[2,7,23,25,30,42]中提取特征。然而，为了避免棘手的计算时间复杂度和内存消耗，体素方法仅应用在小型的空间分辨率，这导致了量化伪影和难以学习几何结构的细节，除了最近使用八叉树（Octree ）[32,41]的一些改进。

与卷积网不同，PointNet [29]提供了一个有效而简单的架构，可以直接学习点集。首先计算每个点的多层感知器（MLP）的单个点特征，然后将所有特征聚合为点云的全局表示。而在不同的三维语义学习任务上实现的最先进的结果，从每个点特征到全局特征的直接聚合表明PointNet没有充分利用点的局部结构来捕获细粒度模式：每个点的多层感知器（MLP）的输出仅粗糙地编码了一个三维点的存在性，这个三维点是在这个三维空间中的一个确定的非线性划分中。如果MLP不仅可以编码点的存在性，还可以编码在非线性三维空间的划分中存在的一个点的特征（例如，角对平面、凸与凹等），则一个更有判别性的表示是可以期待的。本文的动机就是从三维物体表面上的点的局部邻域中学习这种特征信息。

为了解决上述问题，PointNet++ [31]提出将一个点集分割成更小的集群，并且将这个小集群输入到小的PointNet，并对高维特征点集迭代地重复这样的过程，这导致复杂的架构并且降低了网络速度。因此，我们试图从一个不同的方向来探索：是否有任何有效的可学习的局部操作与清晰的几何解释，以帮助直接增强和改进原始的点网，同时保持其简单的体系结构？

为了解决这个问题，我们在三维点云上，基于两个经典的有监督的特征表示学习任务，通过两种新的操作来利用局部几何信息和特征结构，从而改善PointNet，详见图2。贡献如下：

- 我们提出了一个核相关层来利用局部几何结构，并具有清晰的几何解释（见图1和图3）。
- 我们提出了一种基于图的池化层来利用局部特征结构来增强网络的鲁棒性。
- 我们的KCNet利用这两种新操作有效地提高了点云语义学习性能。

![image-20231204170629437](/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/%E4%B8%89%E7%BB%B4%E5%A4%84%E7%90%86/%E7%82%B9%E4%BA%91/%E7%82%B9%E4%BA%91%E7%89%B9%E5%BE%81/images/Mining%20point%20cloud%20local%20structures%20by%20kernel%20correlation%20and%20graph%20pooling/image-20231204170629437.png)

图2：我们的KCNet架构。通过前端核相关层探索局部几何结构，相关层计算了每个数据点的$K$个最近邻点和$L$个点集核之间的$L$个不同的匹配度，每个前端核包含了$M$个可以学习的三维点。所得到的响应与原始的三维坐标拼接起来。局部特征结构被后续的图池化层利用，从每个点的三维欧氏邻域中离线地构建的每个三维对象实例共享一个相同的图池化层。每层都使用ReLU，但是没有层归一化（BatchNormalization），DropOut用于最后一层的MLP。其他操作和基础网络架构在形状分类和零件分割方面都类似于PointNet [29]。实心箭头表示带有反向传播的正向操作，而虚线箭头表示没有反向传播。绿框是输入数据，灰色是中间变量，蓝色是网络预测。我们的网络简称为KCNet。

# Ch02 相关工作

## 2.1. 局部几何特性

我们将首先讨论三维数据中经常使用的一些局部几何特性，以及它们如何引导我们通过修改核相关性使其作为一种工具，以实现潜在的复杂数据驱动的局部几何结构的刻画。

### 表面法线

表面法线作为一种基本的曲面性质，在三维形状重建、平面提取和点集配准[5,14,28,39,40]等许多领域得到了广泛的应用。它们通常直接来自于CAD模型，也可以通过主成分分析（PCA）对相邻点的数据协方差矩阵作为最小方差方向[15]进行估计。在PointNet中使用对点曲面法线对应于将一个点的局部邻域建模为一个平面，如[29,31]所示，与仅使用三维坐标的模型相比，提高了性能。这个结果符合我们之前的期望，即一个点的“类型”特征叠加位置特征应该具有更好地表示。然而，这也引出了我们的一个问题：因为法线可以从3D坐标（不像颜色或强度）来估计，那么为什么PointNet只使用三维坐标作为输入导致不能获得同样的好处？我们认为这是由于以下原因： 1)每个点MLP不能仅靠3D坐标来捕获近邻信息，2)全局池化操作不能或不足以实现这一目标。

### 协方差矩阵

通过数据协方差矩阵实现局部领域的二阶描述，这类矩阵已经广泛应用于平面提取、曲率和法线估计等情况[11,14]。按照来自法线估计的相同思路，局部数据协方差矩阵提供的信息实际上比法线更丰富，因为它将局部邻域建模为一个椭球体，球体之中包括秩亏缺情况下的线和平面。我们还根据经验观察到，矩阵在语义学习方面优于法线。

然而，表面法线和协方差矩阵都可以看作是局部形状的有限描述，这种描述是手工制作的和有限的，因为完全不同形状的点集可以共享一个相似的数据协方差矩阵。当然，为了提高细粒度类别的三维语义形状分类和三维语义分割的性能，需要对每个点的局部邻域进行更详细的分析。尽管PointNet++ [31]是学习更有区别的描述的一种直接方法，但它可能不是最有效的解决方案。相反，我们希望找到一个可学习的局部描述，该描述简单高效，并且具有清晰的几何解释，就像上面两个手工制作的特征一样，这样它就可以直接插入到原始的、优雅的PointNet架构中。

### 核相关性

另一个被广泛使用的描述是相似性。对于图像，卷积（通常实现为互相关）可以量化输入图像和卷积核[21]之间的相似性。然而，面对上述定义的点云卷积的挑战，我们该如何测量两个点集之间的相关性？这个问题引导我们找到了核相关[17,38]作为这样一个工具。研究表明，核相关作为成对的点距离函数是测量二维/三维点集之间几何匹配度的一种有效方法，并已用于点云配准和特征对应问题[17,33,38]。特别是，对于配准，通过迭代精调两者之间的刚性/非刚性转换，从而最大化其核相关响应，使其满足与参考云的最佳匹配。因此，我们提出了核相关层，分别将局部相邻点和一个可学习的点集核作为源和参考，这将在[第3.1节]()中进一步详细介绍。

## 2.2 点云上的深度学习

近年来，对三维输入数据的深度学习，特别是点云，越来越受到越来越多的研究关注。有四种方法：基于体积的方法，基于补丁的方法，基于图的方法和基于点的方法。基于体积的方法将三维空间划分为规则的体素，并在体素[2,7,23,25,30,42]上应用三维卷积。然而，体积表示需要很高的内存和计算成本来提高空间分辨率。最近，基于八叉树和基于KD-树的网络已经被引入，但它们仍然可能存在内存效率问题[20,32,41]。基于补丁的方法将三维曲面参数化为局部补丁，并在这些补丁上应用卷积[3,24]。这种方法的优点是表面变形的不变性。然而，从网格推广到点云[43]并不容易。基于图的方法是通过图来表征点云。很自然，图表示可以灵活地表示不规则数据，甚至是非欧数据，如：点云、社交网络上的用户数据和基因数据[1,9,18,19,26,27,27]。因此，可以使用连通性图或多边形网格来表示三维点云，将图或者网络转换为谱表示，并在谱域[4,8,10,13,19,22]中应用卷积。另一项工作[^34]还研究了图中一个顶点的领域的边属性的卷积，该图是建立在点云之上的。基于点的方法，如：PointNet，则直接操作于点云，为每个点学习得到空间特征，并通过最大池化操作[29]聚合点特征获得全局特征。

PointNet对于形状分类和分割类的应用是简单而且有效的。然而，没有明确考虑局部结构的全局聚合错过了捕获细粒度模式的机会，并且对噪声具有敏感性。为了进一步将PointNet扩展到局部结构，我们使用了一个简单的基于图的网络：构造$k$个最近邻图（KNNG），在发现局部点共享相似的几何结构后，利用邻域信息进行核相关计算，并在每个节点邻域进行最大池化操作。KNNG通常用于建立局部连通性信息，从而满足在点云的表面检测、三维目标识别、三维目标分割和压缩等中应用[12,35,37]。

# Ch03 方法

我们现在通过1)核相关性（度量点集的几何匹配性）和2)KNNG（在相邻点之间传播的局部特征）来解释在点邻域上学习得到局部结构的细节，详见图2。

## 3.1. 局部几何结构上的学习

如前所述，我们从基于核相关的点云配准中获得了灵感。在网络前端，我们将一个点的局部邻域作为源，以及一组可学习的点（即：核）作为参考，刻画某些类型的局部几何结构/形状。

我们修改了原始的核相关计算方法，允许参考通过反向传播自由地调整其形状（即：核点位置）。请注意，与点集配准相比，这里的视角发生了变化：我们希望通过自由的每点转换来学习模板/参考形状，而不是使用固定的模板来寻找源点集和参考点集之间的最优转换。通过这种方式，一组可学习的核点类似于卷积核，它只激活其联合相邻区域的点，并捕获这个以核函数及其核宽度为特征的接受域内的局部几何结构。在这种情况下，学习过程可以看作是寻找一组参考/模板点，编码最有效和最有用的局部几何结构，从而与网络中的其他参数共同获得最佳的学习性能。
